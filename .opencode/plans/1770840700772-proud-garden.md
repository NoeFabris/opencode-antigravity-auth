# Plan: Remove Deprecated Claude Opus 4.5 Model

**Issue:** [#424](https://github.com/NoeFabris/opencode-antigravity-auth/issues/424) - Opus-4-5 is deprecated on Antigravity  
**Date:** 2026-02-12

## Summary

Remove all references to Claude Opus 4.5 (`claude-opus-4-5-thinking`) from the codebase since it's been deprecated on the Antigravity API. Users should use Opus 4.6 instead.

## Context

- The model `antigravity-claude-opus-4-5-thinking` has been deprecated on the Antigravity API
- Users confirmed that changing to `antigravity-claude-opus-4-6-thinking` works
- Opus 4.6 is already fully defined in the codebase - this is just a removal

## Implementation Plan

### Phase 1: Source Code (2 files)

| File | Change |
|------|--------|
| `src/plugin/config/models.ts:75-83` | Remove `antigravity-claude-opus-4-5-thinking` definition |
| `src/plugin/transform/model-resolver.ts:54-56` | Remove 3 MODEL_ALIASES entries for opus-4-5 |

### Phase 2: Test Files (6 files)

Replace `opus-4-5` â†’ `opus-4-6` in:

| File | Lines |
|------|-------|
| `src/plugin/transform/model-resolver.test.ts` | 117-120, 211-217 |
| `src/plugin/transform/cross-model-sanitizer.test.ts` | 14, 304, 432, 519 |
| `src/plugin/transform/claude.test.ts` | 19, 32, 51, 53, 63, 68 |
| `src/plugin/cross-model-integration.test.ts` | 58, 70, 132, 198, 362, 434 |
| `src/plugin/config/models.test.ts` | 18, 51 |
| `src/plugin/accounts.test.ts` | 1838 |

### Phase 3: Scripts (4 files)

| File | Change |
|------|--------|
| `script/test-regression.ts:58` | Update CLAUDE_OPUS constant to opus-4-6 |
| `script/test-models.ts:26-28` | Update model test entries to opus-4-6 |
| `script/test-cross-model.ts:62,75` | Update model references |
| `script/test-cross-model-e2e.sh` | Update 8 references (lines 7, 55, 80, 122, 188, 193, 231, 258) |

### Phase 4: Documentation (4 files)

| File | Change |
|------|--------|
| `README.md:9,12-13` | Update model references |
| `AGENTS.md:7` | Update overview |
| `docs/ANTIGRAVITY_API_SPEC.md:83` | Remove Opus 4.5 from model list |
| `.github/ISSUE_TEMPLATE/bug_report.yml:48` | Remove from dropdown |

### Phase 5: Comment Update (1 file)

| File | Change |
|------|--------|
| `src/plugin/request.ts:722` | Update comment example |

## Verification

```bash
# 1. Run tests
npm test

# 2. Type check
npm run typecheck

# 3. Build
npm run build

# 4. Verify no remaining references
grep -r "opus-4-5" --include="*.ts" --include="*.md" --include="*.sh" --include="*.yml"
# Should return 0 matches
```

## Files to Modify

**Source (2):**
- `src/plugin/config/models.ts`
- `src/plugin/transform/model-resolver.ts`

**Tests (6):**
- `src/plugin/transform/model-resolver.test.ts`
- `src/plugin/transform/cross-model-sanitizer.test.ts`
- `src/plugin/transform/claude.test.ts`
- `src/plugin/cross-model-integration.test.ts`
- `src/plugin/config/models.test.ts`
- `src/plugin/accounts.test.ts`

**Scripts (4):**
- `script/test-regression.ts`
- `script/test-models.ts`
- `script/test-cross-model.ts`
- `script/test-cross-model-e2e.sh`

**Docs (4):**
- `README.md`
- `AGENTS.md`
- `docs/ANTIGRAVITY_API_SPEC.md`
- `.github/ISSUE_TEMPLATE/bug_report.yml`

**Comment (1):**
- `src/plugin/request.ts`

## Risk Assessment

**Low Risk** - Opus 4.6 already exists and is working. This is purely a removal of deprecated references with no new functionality.
