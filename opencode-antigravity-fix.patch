diff --git a/README.md b/README.md
index d08d1e5..65d3454 100644
--- a/README.md
+++ b/README.md
@@ -333,9 +333,9 @@ Invalid JSON payload received. Unknown name "parameters" at 'request.tools[0]'
 - Plugin version regression
 
 **Solutions:**
-1. **Update to latest beta:**
+1. **Update to latest plugin:**
    ```json
-   { "plugin": ["opencode-antigravity-auth@beta"] }
+   { "plugin": ["opencode-antigravity-auth@latest"] }
    ```
 
 2. **Disable MCP servers** one-by-one to find the problematic one
@@ -372,10 +372,10 @@ This usually means an MCP tool name starts with a number (for example, a 1mcp ke
 
 ### "All Accounts Rate-Limited" (But Quota Available)
 
-**Cause:** Cascade bug in `clearExpiredRateLimits()` in hybrid mode (fixed in recent beta).
+**Cause:** Cascade bug in `clearExpiredRateLimits()` in hybrid mode (fixed in recent versions).
 
 **Solutions:**
-1. Update to latest beta version
+1. Update to latest plugin version
 2. If persists, delete accounts file and re-authenticate
 3. Try switching `account_selection_strategy` to `"sticky"` in `antigravity.json`
 
@@ -494,7 +494,7 @@ The correct key is `plugin` (singular):
 
 ```json
 {
-  "plugin": ["opencode-antigravity-auth@beta"]
+  "plugin": ["opencode-antigravity-auth@latest"]
 }
 ```
 
@@ -505,7 +505,7 @@ The correct key is `plugin` (singular):
 ### Migrating Accounts Between Machines
 
 When copying `antigravity-accounts.json` to a new machine:
-1. Ensure the plugin is installed: `"plugin": ["opencode-antigravity-auth@beta"]`
+1. Ensure the plugin is installed: `"plugin": ["opencode-antigravity-auth@latest"]`
 2. Copy `~/.config/opencode/antigravity-accounts.json`
 3. If you get "API key missing" error, the refresh token may be invalid â€” re-authenticate
 
diff --git a/docs/TROUBLESHOOTING.md b/docs/TROUBLESHOOTING.md
index 4a0abc0..f951c41 100644
--- a/docs/TROUBLESHOOTING.md
+++ b/docs/TROUBLESHOOTING.md
@@ -30,6 +30,22 @@ rm ~/.config/opencode/antigravity-accounts.json
 opencode auth login
 ```
 
+### "This version of Antigravity is no longer supported"
+This almost always means an outdated Antigravity `User-Agent` is still being used.
+
+1) Stop any running OpenCode processes (stale processes can overwrite your accounts file):
+```bash
+pkill -f opencode || true
+```
+
+2) Clear the plugin caches and re-login:
+```bash
+rm -f ~/.config/opencode/antigravity-accounts.json
+rm -rf ~/.cache/opencode/node_modules/opencode-antigravity-auth
+rm -rf ~/.bun/install/cache/opencode-antigravity-auth*
+opencode auth login
+```
+
 ### "Model not found"
 Add this to your `google` provider config:
 ```json
@@ -45,7 +61,7 @@ The correct key is `plugin` (singular):
 
 ```json
 {
-  "plugin": ["opencode-antigravity-auth@beta"]
+  "plugin": ["opencode-antigravity-auth@latest"]
 }
 ```
 
diff --git a/package-lock.json b/package-lock.json
index 8d50b23..c103668 100644
--- a/package-lock.json
+++ b/package-lock.json
@@ -1,21 +1,21 @@
 {
     "name": "opencode-antigravity-auth",
-    "version": "1.3.0",
+    "version": "1.4.3",
     "lockfileVersion": 3,
     "requires": true,
     "packages": {
         "": {
             "name": "opencode-antigravity-auth",
-            "version": "1.3.0",
+            "version": "1.4.3",
             "license": "MIT",
             "dependencies": {
                 "@openauthjs/openauth": "^0.4.3",
+                "@opencode-ai/plugin": "^0.15.30",
                 "proper-lockfile": "^4.1.2",
                 "xdg-basedir": "^5.1.0",
                 "zod": "^4.0.0"
             },
             "devDependencies": {
-                "@opencode-ai/plugin": "^0.15.30",
                 "@types/node": "^24.10.1",
                 "@types/proper-lockfile": "^4.1.4",
                 "@vitest/coverage-v8": "^3.0.0",
@@ -632,7 +632,6 @@
             "version": "0.15.31",
             "resolved": "https://registry.npmjs.org/@opencode-ai/plugin/-/plugin-0.15.31.tgz",
             "integrity": "sha512-htKKCq9Htljf7vX5ANLDB7bU7TeJYrl8LP2CQUtCAguKUpVvpj5tiZ+edlCdhGFEqlpSp+pkiTEY5LCv1muowg==",
-            "dev": true,
             "dependencies": {
                 "@opencode-ai/sdk": "0.15.31",
                 "zod": "4.1.8"
@@ -642,7 +641,6 @@
             "version": "4.1.8",
             "resolved": "https://registry.npmjs.org/zod/-/zod-4.1.8.tgz",
             "integrity": "sha512-5R1P+WwQqmmMIEACyzSvo4JXHY5WiAFHRMg+zBZKgKS+Q1viRa0C1hmUKtHltoIFKtIdki3pRxkmpP74jnNYHQ==",
-            "dev": true,
             "license": "MIT",
             "funding": {
                 "url": "https://github.com/sponsors/colinhacks"
@@ -651,14 +649,14 @@
         "node_modules/@opencode-ai/sdk": {
             "version": "0.15.31",
             "resolved": "https://registry.npmjs.org/@opencode-ai/sdk/-/sdk-0.15.31.tgz",
-            "integrity": "sha512-95HWBiNKQnwsubkR2E7QhBD/CH9yteZGrviWar0aKHWu8/RjWw9m7Znbv8DI+y6i2dMwBBcGQ8LJ7x0abzys4A==",
-            "dev": true
+            "integrity": "sha512-95HWBiNKQnwsubkR2E7QhBD/CH9yteZGrviWar0aKHWu8/RjWw9m7Znbv8DI+y6i2dMwBBcGQ8LJ7x0abzys4A=="
         },
         "node_modules/@oslojs/asn1": {
             "version": "1.0.0",
             "resolved": "https://registry.npmjs.org/@oslojs/asn1/-/asn1-1.0.0.tgz",
             "integrity": "sha512-zw/wn0sj0j0QKbIXfIlnEcTviaCzYOY3V5rAyjR6YtOByFtJiT574+8p9Wlach0lZH9fddD4yb9laEAIl4vXQA==",
             "license": "MIT",
+            "peer": true,
             "dependencies": {
                 "@oslojs/binary": "1.0.0"
             }
@@ -667,13 +665,15 @@
             "version": "1.0.0",
             "resolved": "https://registry.npmjs.org/@oslojs/binary/-/binary-1.0.0.tgz",
             "integrity": "sha512-9RCU6OwXU6p67H4NODbuxv2S3eenuQ4/WFLrsq+K/k682xrznH5EVWA7N4VFk9VYVcbFtKqur5YQQZc0ySGhsQ==",
-            "license": "MIT"
+            "license": "MIT",
+            "peer": true
         },
         "node_modules/@oslojs/crypto": {
             "version": "1.0.1",
             "resolved": "https://registry.npmjs.org/@oslojs/crypto/-/crypto-1.0.1.tgz",
             "integrity": "sha512-7n08G8nWjAr/Yu3vu9zzrd0L9XnrJfpMioQcvCMxBIiF5orECHe5/3J0jmXRVvgfqMm/+4oxlQ+Sq39COYLcNQ==",
             "license": "MIT",
+            "peer": true,
             "dependencies": {
                 "@oslojs/asn1": "1.0.0",
                 "@oslojs/binary": "1.0.0"
@@ -683,13 +683,15 @@
             "version": "1.1.0",
             "resolved": "https://registry.npmjs.org/@oslojs/encoding/-/encoding-1.1.0.tgz",
             "integrity": "sha512-70wQhgYmndg4GCPxPPxPGevRKqTIJ2Nh4OkiMWmDAVYsTQ+Ta7Sq+rPevXyXGdzr30/qZBnyOalCszoMxlyldQ==",
-            "license": "MIT"
+            "license": "MIT",
+            "peer": true
         },
         "node_modules/@oslojs/jwt": {
             "version": "0.2.0",
             "resolved": "https://registry.npmjs.org/@oslojs/jwt/-/jwt-0.2.0.tgz",
             "integrity": "sha512-bLE7BtHrURedCn4Mco3ma9L4Y1GR2SMBuIvjWr7rmQ4/W/4Jy70TIAgZ+0nIlk0xHz1vNP8x8DCns45Sb2XRbg==",
             "license": "MIT",
+            "peer": true,
             "dependencies": {
                 "@oslojs/encoding": "0.4.1"
             }
@@ -698,7 +700,8 @@
             "version": "0.4.1",
             "resolved": "https://registry.npmjs.org/@oslojs/encoding/-/encoding-0.4.1.tgz",
             "integrity": "sha512-hkjo6MuIK/kQR5CrGNdAPZhS01ZCXuWDRJ187zh6qqF2+yMHZpD9fAYpX8q2bOO6Ryhl3XpCT6kUX76N8hhm4Q==",
-            "license": "MIT"
+            "license": "MIT",
+            "peer": true
         },
         "node_modules/@pkgjs/parseargs": {
             "version": "0.11.0",
@@ -1063,7 +1066,6 @@
             "integrity": "sha512-GNWcUTRBgIRJD5zj+Tq0fKOJ5XZajIiBroOF0yvj2bSU1WvNdYS/dn9UxwsujGW4JX06dnHyjV2y9rRaybH0iQ==",
             "dev": true,
             "license": "MIT",
-            "peer": true,
             "dependencies": {
                 "undici-types": "~7.16.0"
             }
@@ -1225,7 +1227,6 @@
             "integrity": "sha512-hGISOaP18plkzbWEcP/QvtRW1xDXF2+96HbEX6byqQhAUbiS5oH6/9JwW+QsQCIYON2bI6QZBF+2PvOmrRZ9wA==",
             "dev": true,
             "license": "MIT",
-            "peer": true,
             "dependencies": {
                 "@vitest/utils": "3.2.4",
                 "fflate": "^0.8.2",
@@ -1922,7 +1923,6 @@
             "integrity": "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q==",
             "dev": true,
             "license": "MIT",
-            "peer": true,
             "engines": {
                 "node": ">=12"
             },
@@ -2365,7 +2365,6 @@
             "integrity": "sha512-ITcnkFeR3+fI8P1wMgItjGrR10170d8auB4EpMLPqmx6uxElH3a/hHGQabSHKdqd4FXWO1nFIp9rRn7JQ34ACQ==",
             "dev": true,
             "license": "MIT",
-            "peer": true,
             "dependencies": {
                 "esbuild": "^0.25.0",
                 "fdir": "^6.5.0",
@@ -2464,7 +2463,6 @@
             "integrity": "sha512-LUCP5ev3GURDysTWiP47wRRUpLKMOfPh+yKTx3kVIEiu5KOMeqzpnYNsKyOoVrULivR8tLcks4+lga33Whn90A==",
             "dev": true,
             "license": "MIT",
-            "peer": true,
             "dependencies": {
                 "@types/chai": "^5.2.2",
                 "@vitest/expect": "3.2.4",
@@ -2680,7 +2678,6 @@
             "resolved": "https://registry.npmjs.org/zod/-/zod-4.3.5.tgz",
             "integrity": "sha512-k7Nwx6vuWx1IJ9Bjuf4Zt1PEllcwe7cls3VNzm4CQ1/hgtFUK2bRNG3rvnpPUhFjmqJKAKtjV576KnUkHocg/g==",
             "license": "MIT",
-            "peer": true,
             "funding": {
                 "url": "https://github.com/sponsors/colinhacks"
             }
diff --git a/src/hooks/auto-update-checker/cache.ts b/src/hooks/auto-update-checker/cache.ts
index f97cd06..55aadad 100644
--- a/src/hooks/auto-update-checker/cache.ts
+++ b/src/hooks/auto-update-checker/cache.ts
@@ -1,7 +1,13 @@
 import * as fs from "node:fs";
 import * as path from "node:path";
+import * as os from "node:os";
 import { CACHE_DIR, PACKAGE_NAME } from "./constants";
 
+function getOpencodeConfigDir(): string {
+  const xdgConfig = process.env.XDG_CONFIG_HOME || path.join(os.homedir(), ".config");
+  return path.join(xdgConfig, "opencode");
+}
+
 interface BunLockfile {
   workspaces?: {
     ""?: {
@@ -15,8 +21,7 @@ function stripTrailingCommas(json: string): string {
   return json.replace(/,(\s*[}\]])/g, "$1");
 }
 
-function removeFromBunLock(packageName: string): boolean {
-  const lockPath = path.join(CACHE_DIR, "bun.lock");
+function removeFromBunLockAt(lockPath: string, packageName: string): boolean {
   if (!fs.existsSync(lockPath)) return false;
 
   try {
@@ -36,7 +41,7 @@ function removeFromBunLock(packageName: string): boolean {
 
     if (modified) {
       fs.writeFileSync(lockPath, JSON.stringify(lock, null, 2));
-      console.log(`[auto-update-checker] Removed from bun.lock: ${packageName}`);
+      console.log(`[auto-update-checker] Removed from bun.lock: ${packageName} (${lockPath})`);
     }
 
     return modified;
@@ -45,35 +50,94 @@ function removeFromBunLock(packageName: string): boolean {
   }
 }
 
+function removeFromBunInstallCache(packageName: string): boolean {
+  const cacheDir =
+    process.env.BUN_INSTALL_CACHE_DIR ||
+    path.join(os.homedir(), ".bun", "install", "cache");
+
+  try {
+    if (!fs.existsSync(cacheDir)) return false;
+    const entries = fs.readdirSync(cacheDir, { withFileTypes: true });
+    let removed = false;
+
+    for (const entry of entries) {
+      if (!entry.name.startsWith(packageName)) continue;
+      const fullPath = path.join(cacheDir, entry.name);
+      try {
+        fs.rmSync(fullPath, { recursive: true, force: true });
+        removed = true;
+      } catch {
+        // best-effort
+      }
+    }
+
+    if (removed) {
+      console.log(`[auto-update-checker] Removed from bun install cache: ${packageName}`);
+    }
+
+    return removed;
+  } catch {
+    return false;
+  }
+}
+
 export function invalidatePackage(packageName: string = PACKAGE_NAME): boolean {
   try {
-    const pkgDir = path.join(CACHE_DIR, "node_modules", packageName);
-    const pkgJsonPath = path.join(CACHE_DIR, "package.json");
+    const cachePkgDir = path.join(CACHE_DIR, "node_modules", packageName);
+    const cachePkgJsonPath = path.join(CACHE_DIR, "package.json");
+
+    const configDir = getOpencodeConfigDir();
+    const configPkgDir = path.join(configDir, "node_modules", packageName);
+    const configPkgJsonPath = path.join(configDir, "package.json");
 
     let packageRemoved = false;
     let dependencyRemoved = false;
     let lockRemoved = false;
+    let bunInstallCacheRemoved = false;
 
-    if (fs.existsSync(pkgDir)) {
-      fs.rmSync(pkgDir, { recursive: true, force: true });
-      console.log(`[auto-update-checker] Package removed: ${pkgDir}`);
+    if (fs.existsSync(cachePkgDir)) {
+      fs.rmSync(cachePkgDir, { recursive: true, force: true });
+      console.log(`[auto-update-checker] Package removed: ${cachePkgDir}`);
       packageRemoved = true;
     }
 
-    if (fs.existsSync(pkgJsonPath)) {
-      const content = fs.readFileSync(pkgJsonPath, "utf-8");
+    if (fs.existsSync(configPkgDir)) {
+      fs.rmSync(configPkgDir, { recursive: true, force: true });
+      console.log(`[auto-update-checker] Package removed: ${configPkgDir}`);
+      packageRemoved = true;
+    }
+
+    if (fs.existsSync(cachePkgJsonPath)) {
+      const content = fs.readFileSync(cachePkgJsonPath, "utf-8");
       const pkgJson = JSON.parse(content);
       if (pkgJson.dependencies?.[packageName]) {
         delete pkgJson.dependencies[packageName];
-        fs.writeFileSync(pkgJsonPath, JSON.stringify(pkgJson, null, 2));
-        console.log(`[auto-update-checker] Dependency removed from package.json: ${packageName}`);
+        fs.writeFileSync(cachePkgJsonPath, JSON.stringify(pkgJson, null, 2));
+        console.log(`[auto-update-checker] Dependency removed from package.json: ${packageName} (${cachePkgJsonPath})`);
         dependencyRemoved = true;
       }
     }
 
-    lockRemoved = removeFromBunLock(packageName);
+    if (fs.existsSync(configPkgJsonPath)) {
+      const content = fs.readFileSync(configPkgJsonPath, "utf-8");
+      const pkgJson = JSON.parse(content);
+      if (pkgJson.dependencies?.[packageName]) {
+        delete pkgJson.dependencies[packageName];
+        fs.writeFileSync(configPkgJsonPath, JSON.stringify(pkgJson, null, 2));
+        console.log(`[auto-update-checker] Dependency removed from package.json: ${packageName} (${configPkgJsonPath})`);
+        dependencyRemoved = true;
+      }
+    }
+
+    lockRemoved =
+      removeFromBunLockAt(path.join(CACHE_DIR, "bun.lock"), packageName) ||
+      removeFromBunLockAt(path.join(configDir, "bun.lock"), packageName);
+
+    // Some environments (notably Bun-based plugin runners) may keep stale copies of packages
+    // in Bun's global install cache. Best-effort removal helps ensure updated versions are used.
+    bunInstallCacheRemoved = removeFromBunInstallCache(packageName);
 
-    if (!packageRemoved && !dependencyRemoved && !lockRemoved) {
+    if (!packageRemoved && !dependencyRemoved && !lockRemoved && !bunInstallCacheRemoved) {
       console.log(`[auto-update-checker] Package not found, nothing to invalidate: ${packageName}`);
       return false;
     }
diff --git a/src/hooks/auto-update-checker/checker.ts b/src/hooks/auto-update-checker/checker.ts
index e2792e7..b67eeff 100644
--- a/src/hooks/auto-update-checker/checker.ts
+++ b/src/hooks/auto-update-checker/checker.ts
@@ -139,16 +139,6 @@ export function findPluginEntry(directory: string): PluginEntryInfo | null {
 }
 
 export function getCachedVersion(): string | null {
-  try {
-    if (fs.existsSync(INSTALLED_PACKAGE_JSON)) {
-      const content = fs.readFileSync(INSTALLED_PACKAGE_JSON, "utf-8");
-      const pkg = JSON.parse(content) as PackageJson;
-      if (pkg.version) return pkg.version;
-    }
-  } catch {
-    return null;
-  }
-
   try {
     const currentDir = path.dirname(fileURLToPath(import.meta.url));
     const pkgPath = findPackageJsonUp(currentDir);
@@ -161,6 +151,17 @@ export function getCachedVersion(): string | null {
     debugLog(`[auto-update-checker] Failed to resolve version from current directory: ${err}`);
   }
 
+  // Fallback: use the cached install path (may be stale if multiple installs exist).
+  try {
+    if (fs.existsSync(INSTALLED_PACKAGE_JSON)) {
+      const content = fs.readFileSync(INSTALLED_PACKAGE_JSON, "utf-8");
+      const pkg = JSON.parse(content) as PackageJson;
+      if (pkg.version) return pkg.version;
+    }
+  } catch {
+    return null;
+  }
+
   return null;
 }
 
diff --git a/src/plugin/accounts.ts b/src/plugin/accounts.ts
index 078eb36..dac47f0 100644
--- a/src/plugin/accounts.ts
+++ b/src/plugin/accounts.ts
@@ -257,6 +257,38 @@ export class AccountManager {
 
   static async loadFromDisk(authFallback?: OAuthAuthDetails): Promise<AccountManager> {
     const stored = await loadAccounts();
+
+    // If fingerprints are outdated (e.g., Antigravity version bumped), update and persist immediately.
+    // This avoids relying on debounced saves (which may not fire before process exit) and reduces
+    // the chance that an older process re-writes stale versions back to disk.
+    if (stored && stored.accounts.length > 0) {
+      let didUpdate = false;
+      const updatedAccounts = stored.accounts.map((acc) => {
+        if (!acc?.fingerprint) {
+          return acc;
+        }
+        const updatedFingerprint = updateFingerprintVersion(acc.fingerprint);
+        if (updatedFingerprint !== acc.fingerprint) {
+          didUpdate = true;
+          return { ...acc, fingerprint: updatedFingerprint };
+        }
+        return acc;
+      });
+
+      if (didUpdate) {
+        try {
+          await saveAccounts({
+            ...stored,
+            accounts: updatedAccounts,
+          });
+        } catch {
+          // best-effort migration; avoid blocking plugin startup
+        }
+      }
+
+      return new AccountManager(authFallback, { ...stored, accounts: updatedAccounts });
+    }
+
     return new AccountManager(authFallback, stored);
   }
 
diff --git a/src/plugin/storage.ts b/src/plugin/storage.ts
index c91ef2b..4d60440 100644
--- a/src/plugin/storage.ts
+++ b/src/plugin/storage.ts
@@ -10,6 +10,7 @@ import { homedir } from "node:os";
 import { randomBytes } from "node:crypto";
 import lockfile from "proper-lockfile";
 import type { HeaderStyle } from "../constants";
+import type { Fingerprint } from "./fingerprint";
 import { createLogger } from "./logger";
 
 const log = createLogger("storage");
@@ -276,6 +277,7 @@ function mergeAccountStorage(
     if (acc.refreshToken) {
       const existingAcc = accountMap.get(acc.refreshToken);
       if (existingAcc) {
+        const mergedFingerprint = mergeFingerprint(existingAcc.fingerprint, acc.fingerprint);
         accountMap.set(acc.refreshToken, {
           ...existingAcc,
           ...acc,
@@ -287,6 +289,8 @@ function mergeAccountStorage(
             ...acc.rateLimitResetTimes,
           },
           lastUsed: Math.max(existingAcc.lastUsed || 0, acc.lastUsed || 0),
+          // Prevent stale processes from downgrading fingerprints back to an older Antigravity version.
+          fingerprint: mergedFingerprint,
         });
       } else {
         accountMap.set(acc.refreshToken, acc);
@@ -302,6 +306,45 @@ function mergeAccountStorage(
   };
 }
 
+function parseAntigravityVersion(userAgent: string | undefined): number[] | null {
+  if (!userAgent) return null;
+  const match = userAgent.match(/\bantigravity\/(\d+(?:\.\d+)*)\b/i);
+  if (!match) return null;
+  const parts = match[1]!.split(".").map((p) => Number.parseInt(p, 10));
+  if (parts.some((n) => !Number.isFinite(n))) return null;
+  return parts;
+}
+
+function compareVersions(a: number[], b: number[]): number {
+  const len = Math.max(a.length, b.length);
+  for (let i = 0; i < len; i++) {
+    const av = a[i] ?? 0;
+    const bv = b[i] ?? 0;
+    if (av !== bv) return av > bv ? 1 : -1;
+  }
+  return 0;
+}
+
+function mergeFingerprint(existing?: Fingerprint, incoming?: Fingerprint): Fingerprint | undefined {
+  if (!incoming) return existing;
+  if (!existing) return incoming;
+
+  const existingVersion = parseAntigravityVersion(existing.userAgent);
+  const incomingVersion = parseAntigravityVersion(incoming.userAgent);
+
+  // Prefer a parseable Antigravity version when possible.
+  if (existingVersion && !incomingVersion) return existing;
+  if (!existingVersion && incomingVersion) return incoming;
+
+  if (existingVersion && incomingVersion) {
+    const cmp = compareVersions(existingVersion, incomingVersion);
+    if (cmp > 0) return existing;
+  }
+
+  // Default to existing behavior (incoming overwrites) when versions are equal/unknown.
+  return incoming;
+}
+
 export function deduplicateAccountsByEmail<
   T extends { email?: string; lastUsed?: number; addedAt?: number },
 >(accounts: T[]): T[] {
